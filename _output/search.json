[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Modelos Lineales Mixtos en R",
    "section": "",
    "text": "Este material presenta un conjunto de tutoriales prácticos enfocados en el análisis de datos de ensayos agrícolas, con énfasis en agricultura de precisión y experimentos en condiciones reales de producción (On-Farm Experiments, OFE).\nSe abordan diferentes tipos de ensayos utilizando herramientas estadísticas modernas, integrando información espacial y ajustando modelos que consideran la estructura real de los datos."
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "🔬 Ensayo con testigos apareados:\nEvaluación del efecto de una práctica de manejo en ambientes contrastantes, utilizando modelos mixtos con y sin correlación espacial.\n🌾 Ensayo de cultivares de trigo (DBCA):\nAnálisis de un ensayo de comparación de cultivares utilizando un diseño en bloques completos al azar, con ajuste de modelos mixtos.\n\n\n\n\n\nBrindar ejemplos reproducibles de análisis de ensayos que integren: - Estadística descriptiva - Modelos lineales mixtos - Modelización espacial - Comparaciones múltiples\nTodos los análisis fueron realizados con R y Quarto, fomentando la reproducibilidad y la comunicación de resultados.\n\n\n\n\nPara dudas o sugerencias, podés contactarme a través de LinkedIn o vía correo institucional."
  },
  {
    "objectID": "MLM_CorrEsp_OFE_Clasif.html",
    "href": "MLM_CorrEsp_OFE_Clasif.html",
    "title": "Diplomatura_MLM_R",
    "section": "",
    "text": "# Manejo de datos\nlibrary(dplyr) \n# Manejo de datos espaciales\nlibrary(sf) \n\n# Graficos\nlibrary(ggplot2) \n# Mapas y graficos de datos espaciales\nlibrary(tmap) \n\n# Ajuste de modelos Mixtos\nlibrary(nlme) \n# Comparacion de medias\nlibrary(emmeans) \n# library(multcomp)"
  },
  {
    "objectID": "MLM_CorrEsp_OFE_Clasif.html#ensayo-agricultura-de-precisión---clasificación",
    "href": "MLM_CorrEsp_OFE_Clasif.html#ensayo-agricultura-de-precisión---clasificación",
    "title": "Diplomatura_MLM_R",
    "section": "Ensayo Agricultura de Precisión - Clasificación",
    "text": "Ensayo Agricultura de Precisión - Clasificación\n\nSe evaluó el efecto de la fertilización fosforada (con y sin zinc) sobre el cultivo.\nEs de interés determinar si existe una respuesta diferencial entre zonas homogéneas, que justifique un manejo específico por ambiente.\n\n\nEstadistica descriptiva\nSe cargan y procesan los datos georreferenciados del ensayo. Se convierten las variables categóricas al formato adecuado para el análisis.\n\ndatos_ensayo_p &lt;- read_sf('Datos/Dia 1/Ensayo_P/Ensayo_P.shp')\n\ndatos_ensayo_p &lt;-\ndatos_ensayo_p |&gt;\n  mutate(BLOQUE = as.character(BLOQUE))\n\ndatos_ensayo_p &lt;- \n  cbind(datos_ensayo_p, \n        st_coordinates(st_centroid(datos_ensayo_p)))\n\nWarning: st_centroid assumes attributes are constant over geometries\n\nhead(datos_ensayo_p)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nZM\nTRATA\nBLOQUE\nRto\nX\nY\ngeometry\n\n\n\n\nAP\nSPS+Zn\n1\n9911.484\n383012.4\n6285446\nPOLYGON ((383010.3 6285449,…\n\n\nAP\nSPS+Zn\n1\n9760.440\n383016.6\n6285447\nPOLYGON ((383014.5 6285449,…\n\n\nAP\nSPS+Zn\n1\n10258.884\n383020.8\n6285447\nPOLYGON ((383018.7 6285449,…\n\n\nAP\nSPS+Zn\n1\n8609.487\n383025.0\n6285447\nPOLYGON ((383022.9 6285449,…\n\n\nAP\nSPS+Zn\n1\n9766.482\n383029.2\n6285447\nPOLYGON ((383027.1 6285449,…\n\n\nAP\nSPS+Zn\n1\n10181.864\n383033.4\n6285447\nPOLYGON ((383031.3 6285449,…\n\n\n\n\n\n\n\ntm_shape(datos_ensayo_p) +\n  tm_polygons(fill = 'Rto')\n\n\n\n\n\n\n\ntm_shape(datos_ensayo_p) +\n  tm_polygons(fill = 'ZM',\n  fill.scale = tm_scale_categorical())\n\n\n\n\n\n\n\ntm_shape(datos_ensayo_p) +\n  tm_polygons(fill = 'BLOQUE',\n  fill.scale = tm_scale_categorical())\n\n\n\n\n\n\n\ntm_shape(datos_ensayo_p) +\n  tm_polygons(fill = 'TRATA',\n  fill.scale = tm_scale_categorical())\n\n\n\n\n\n\n\nggplot(datos_ensayo_p, aes(TRATA, Rto, color = ZM, group = ZM)) +\n  stat_summary()\n\nNo summary function supplied, defaulting to `mean_se()`\n\n\n\n\n\n\n\n\n\n\n\nAjuste de modelo\n\nSin contemplar correlación espacial\nSe ajusta un modelo lineal mixto considerando efectos aleatorios de bloque, pero asumiendo independencia entre unidades experimentales. Este modelo sirve como referencia para evaluar la mejora del ajuste al incorporar estructuras de correlación espacial.\n\nmdl_errores_indep &lt;- lme(Rto ~ ZM + TRATA + ZM*TRATA, \nlist(BLOQUE=pdIdent(~1)),\ndata = datos_ensayo_p)\n\n\n\nContemplando correlación espacial\nSe ajustan modelos mixtos incorporando estructuras de correlación espacial de diferentes tipos (exponencial, gaussiana, lineal, esférica y racional cuadrática) entre unidades experimentales, usando las coordenadas X e Y. El objetivo es capturar la dependencia espacial entre observaciones cercanas.\n\nmdl_errores_corr_exp &lt;- lme(Rto ~ ZM + TRATA + ZM*TRATA, \nrandom = list(BLOQUE=pdIdent(~1)),\ncorrelation = corExp(form=~ X + Y,\nnugget=FALSE,\nmetric='euclidean'),\ndata = datos_ensayo_p)\n\nmdl_errores_corr_gau &lt;- lme(Rto ~ ZM + TRATA + ZM*TRATA, \nrandom = list(BLOQUE=pdIdent(~1)),\ncorrelation = corGaus(form=~ X + Y,\nnugget=FALSE,\nmetric='euclidean'),\ndata = datos_ensayo_p)\n\nmdl_errores_corr_lin &lt;- lme(Rto ~ ZM + TRATA + ZM*TRATA, \nrandom = list(BLOQUE=pdIdent(~1)),\ncorrelation = corLin(form=~ X + Y,\nnugget=FALSE,\nmetric='euclidean'),\ndata = datos_ensayo_p)\n\nmdl_errores_corr_spher &lt;- lme(Rto ~ ZM + TRATA + ZM*TRATA, \nrandom = list(BLOQUE=pdIdent(~1)),\ncorrelation = corSpher(form=~ X + Y,\nnugget=FALSE,\nmetric='euclidean'),\ndata = datos_ensayo_p)\n\nmdl_errores_corr_rationalquad&lt;- lme(Rto ~ ZM + TRATA + ZM*TRATA, \nrandom = list(BLOQUE=pdIdent(~1)),\ncorrelation = corRatio(form=~ X + Y,\nnugget=FALSE,\nmetric='euclidean'),\ndata = datos_ensayo_p)\n\n\n\n\nComparacion de modelos\nSe comparan los distintos modelos ajustados usando los criterios AIC y BIC. Estos indicadores permiten evaluar el compromiso entre ajuste y complejidad del modelo. Se seleccionará el modelo con menor AIC y BIC, siempre que sea consistente con la evaluación de los residuos.\n\ndata.frame(\n  Modelo = c('Errores Independientes',\n             'Correlacion Espacial (Exp)',\n             'Correlacion Espacial (Gaussian)',\n             'Correlacion Espacial (Linear)',\n             'Correlacion Espacial (Spheric)',\n             'Correlacion Espacial (Rational Quadratic)'),\n  AIC = c(AIC(mdl_errores_indep), \n          AIC(mdl_errores_corr_exp),\n          AIC(mdl_errores_corr_gau),\n          AIC(mdl_errores_corr_lin),\n          AIC(mdl_errores_corr_spher),\n          AIC(mdl_errores_corr_rationalquad)),\n  BIC = c(BIC(mdl_errores_indep), \n          BIC(mdl_errores_corr_exp),\n          BIC(mdl_errores_corr_gau),\n          BIC(mdl_errores_corr_lin),\n          BIC(mdl_errores_corr_spher),\n          BIC(mdl_errores_corr_rationalquad))\n) |&gt; \n  arrange(AIC, BIC)\n\n\n\n\n\nModelo\nAIC\nBIC\n\n\n\n\nCorrelacion Espacial (Rational Quadratic)\n11694.42\n11735.41\n\n\nCorrelacion Espacial (Exp)\n11697.09\n11738.08\n\n\nCorrelacion Espacial (Gaussian)\n11714.57\n11755.56\n\n\nCorrelacion Espacial (Spheric)\n11716.16\n11757.15\n\n\nCorrelacion Espacial (Linear)\n11722.57\n11763.56\n\n\nErrores Independientes\n11793.66\n11830.10\n\n\n\n\n\n\n\n\nModelo final\nEl modelo con estructura de correlación racional cuadrática presentó el mejor ajuste según AIC y BIC. A continuación se presentan gráficos diagnósticos para evaluar los residuos del modelo seleccionado: QQ-plot, residuos vs valores ajustados, y distribución de residuos según bloque y tratamiento.\ndatos_ensayo_p$resid_corr_rationalquad &lt;- \n  residuals(mdl_errores_corr_rationalquad, type = 'normalized')\ndatos_ensayo_p$pred_corr_rationalquad &lt;- \n  predict(mdl_errores_corr_rationalquad)\n\nggplot(datos_ensayo_p, aes(sample = resid_corr_rationalquad)) +\n        geom_qq(\n            colour = \"black\",\n            fill = \"aquamarine3\",\n            size = 2,\n            shape = 21\n        ) +\n        geom_qq_line() +\n        theme_bw() +\n        labs(y = \"Standardised Residual\", x = \"Theoretical\")\nggplot(data = datos_ensayo_p,\n        aes(x = pred_corr_rationalquad, y = resid_corr_rationalquad)\n        ) +\n        geom_point(\n            colour = \"black\",\n            fill = \"aquamarine3\",\n            size = 2,\n            shape = 21\n        ) +\n        theme_bw() +\n        labs(y = \"Standardised Residual\", x = \"Fitted Value\")\nggplot(data = datos_ensayo_p,\n        aes(x = BLOQUE, y = resid_corr_rationalquad)\n        ) +\n        geom_boxplot(\n            colour = \"black\",\n            fill = \"aquamarine3\",\n            size = 2,\n            shape = 21\n        ) +\n        theme_bw() +\n        labs(y = \"Standardised Residual\", x = \"Bloque\")\nggplot(data = datos_ensayo_p,\n        aes(x = TRATA, y = resid_corr_rationalquad)\n        ) +\n        geom_boxplot(\n            colour = \"black\",\n            fill = \"aquamarine3\",\n            size = 2,\n            shape = 21\n        ) +\n        theme_bw() +\n        labs(y = \"Standardised Residual\", x = \"Tratamiento\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\njoint_tests(mdl_errores_corr_rationalquad)\n\n\n\n\n\n\nmodel term\ndf1\ndf2\nF.ratio\np.value\n\n\n\n\n1\nZM\n1\n701\n209.302\n0.0000000\n\n\n3\nTRATA\n2\n701\n15.049\n0.0000004\n\n\n2\nZM:TRATA\n2\n701\n3.988\n0.0189525\n\n\n\n\n\n\n\nmodelb &lt;- emmeans(mdl_errores_corr_rationalquad, c(\"ZM\", \"TRATA\"), type = \"response\")\ncomparaciones &lt;- \n  multcomp::cld(modelb, Letters = LETTERS, alpha = 0.05)  |&gt;\n  as.data.frame(row.names = NULL) |&gt;\n  dplyr::rename(mean = emmean) \n\ncomparaciones\n\n\n\n\n\n\nZM\nTRATA\nmean\nSE\ndf\nlower.CL\nupper.CL\n.group\n\n\n\n\n6\nBP\nTESTIGO\n7271.177\n161.8106\n1\n5215.178\n9327.175\nA\n\n\n2\nBP\nSPS\n7300.279\n164.2652\n1\n5213.092\n9387.467\nA\n\n\n4\nBP\nSPS+Zn\n7719.393\n163.0536\n1\n5647.601\n9791.186\nB\n\n\n5\nAP\nTESTIGO\n9133.833\n151.6987\n1\n7206.318\n11061.347\nC\n\n\n1\nAP\nSPS\n9733.552\n153.8408\n1\n7778.818\n11688.285\nD\n\n\n3\nAP\nSPS+Zn\n9822.354\n154.1625\n1\n7863.534\n11781.175\nD\n\n\n\n\n\n\n\nggplot(comparaciones, aes(x = TRATA, y = mean, fill = ZM)) +\n  geom_col(\n    position = position_dodge(width = 0.5),\n    width = 0.5,\n    color = \"black\") +\n  geom_text(aes(label = .group), \n  position = position_dodge(width = 0.5),\n  vjust = -0.5, hjust = 0.5, size = 5) +\n  labs(\n    x = \"Tratamiento\",\n    y = \"Rendimiento promedio ajustado\",\n    fill = \"Zona\"\n  ) +\n  theme_bw() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    plot.title = element_text(hjust = 0.5)\n  )"
  },
  {
    "objectID": "MLM_CorrEsp_OFE_Reg.html",
    "href": "MLM_CorrEsp_OFE_Reg.html",
    "title": "Diplomatura_MLM_R",
    "section": "",
    "text": "# Manejo de datos\nlibrary(dplyr) \n# Manejo de datos espaciales\nlibrary(sf) \n\n# Graficos\nlibrary(ggplot2) \n# Mapas y graficos de datos espaciales\nlibrary(tmap) \n\n# Ajuste de modelos Mixtos\nlibrary(nlme) \n# Comparacion de medias\nlibrary(emmeans)"
  },
  {
    "objectID": "MLM_CorrEsp_OFE_Reg.html#ensayo-agricultura-de-precisión---regresión",
    "href": "MLM_CorrEsp_OFE_Reg.html#ensayo-agricultura-de-precisión---regresión",
    "title": "Diplomatura_MLM_R",
    "section": "Ensayo Agricultura de Precisión - Regresión",
    "text": "Ensayo Agricultura de Precisión - Regresión\n\nSe evaluaron cuatro dosis de nitrógeno (N) en cuatro zonas de manejo.\nEs de interés conocer la dosis óptima de nitrogeno para cada zona homogénea.\n\n\nEstadistica descriptiva\n\n\n\n\n\n\nNote\n\n\n\nSe realiza un muestreo de la base de datos dado la demora computacional en el ajuste del modelo con correlación espacial.\n\n\n\nset.seed(2025)\ndatos_ensayo_n &lt;- read_sf('Datos/Dia 1/Ensayo/EnsayoCurso.shp')\n\ndatos_ensayo_n &lt;-\ndatos_ensayo_n |&gt;\n  mutate(Z = as.character(Z),\n        N2 = N * N) |&gt;\n  group_by(N, Z) |&gt;\n  slice_sample(prop = 0.15)\n\ndatos_ensayo_n &lt;- \n  cbind(datos_ensayo_n, \n        st_coordinates(datos_ensayo_n))\n\nhead(datos_ensayo_n)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nLote\nRto\nN\nZ\nN2\nX\nY\ngeometry\n\n\n\n\nLP08\n6478.404\n0\n1\n0\n416415.4\n6304603\nPOINT (416415.4 6304603)\n\n\nLP08\n6500.213\n0\n1\n0\n416725.4\n6304614\nPOINT (416725.4 6304614)\n\n\nLP08\n6507.766\n0\n1\n0\n416902.8\n6304605\nPOINT (416902.8 6304605)\n\n\nLP08\n6416.383\n0\n1\n0\n416954.2\n6304624\nPOINT (416954.2 6304624)\n\n\nLP08\n6428.191\n0\n1\n0\n416415.8\n6304613\nPOINT (416415.8 6304613)\n\n\nLP08\n6122.872\n0\n1\n0\n416417.6\n6304603\nPOINT (416417.6 6304603)\n\n\n\n\n\n\n\ntm_shape(datos_ensayo_n) +\n  tm_dots(fill = 'Rto')\n\n\n\n\n\n\n\ntm_shape(datos_ensayo_n) +\n  tm_dots(fill = 'Z',\n  fill.scale = tm_scale_categorical())\n\n\n\n\n\n\n\ntm_shape(datos_ensayo_n) +\n  tm_dots(fill = 'N',\n  fill.scale = tm_scale_categorical())\n\n\n\n\n\n\n\nggplot(datos_ensayo_n, aes(N, Rto, color = Z, group = Z)) +\n  stat_summary()\n\nNo summary function supplied, defaulting to `mean_se()`\n\n\n\n\n\n\n\n\n\n\n\nAjuste de modelo\nEl modelo ajustado considera el rendimiento (\\(\\text{Rto}\\)) en función de la zona (\\(Z\\)), la dosis de nitrógeno (\\(N\\)) y sus interacciones hasta el tercer orden.\n\\[\n\\begin{align*}\n\\text{Rto}_i &= \\beta_0 + \\beta_1 \\text{Z}_i + \\beta_2 \\text{N}_i + \\beta_3 \\text{N}_i^2\n+ \\beta_4 (\\text{Z}_i \\cdot \\text{N}_i) + \\beta_5 (\\text{Z}_i \\cdot \\text{N}_i^2)\n+ \\beta_6 (\\text{Z}_i \\cdot \\text{N}_i \\cdot \\text{N}_i^2) + \\varepsilon_i\n\\end{align*}\n\\]\nSe ajustarán modelos de errores independientes (\\(\\varepsilon \\sim \\mathcal{N}(0,I \\sigma^2)\\)) y modelos que contemplen la correlación espacial en función de las coordenadas \\(X\\) e \\(Y\\), sin efecto nugget: \\[\n\\varepsilon \\sim \\mathcal{N}(0, \\sigma^2 \\Sigma)\n\\]\n\n\nAjuste de modelo\n\nSin contemplar correlación espacial\n\nmdl_errores_indep &lt;- gls(Rto ~ N + N2 + Z + N*Z + N2*Z + N*N2*Z,  \ndata = datos_ensayo_n)\n\n\n\nContemplando correlación espacial\n\nmdl_errores_corr_exp &lt;- gls(Rto ~ N + N2 + Z + N*Z + N2*Z + N*N2*Z,  \ncorrelation = corExp(form=~ X + Y,\nnugget=FALSE,\nmetric='euclidean'),\ndata = datos_ensayo_n)\n\nmdl_errores_corr_gau &lt;- gls(Rto ~ N + N2 + Z + N*Z + N2*Z + N*N2*Z,  \ncorrelation = corGaus(form=~ X + Y,\nnugget=FALSE,\nmetric='euclidean'),\ndata = datos_ensayo_n)\n\nmdl_errores_corr_lin &lt;- gls(Rto ~ N + N2 + Z + N*Z + N2*Z + N*N2*Z,  \ncorrelation = corLin(form=~ X + Y,\nnugget=FALSE,\nmetric='euclidean'),\ndata = datos_ensayo_n)\n\nmdl_errores_corr_spher &lt;- gls(Rto ~ N + N2 + Z + N*Z + N2*Z + N*N2*Z,  \ncorrelation = corSpher(form=~ X + Y,\nnugget=FALSE,\nmetric='euclidean'),\ndata = datos_ensayo_n)\n\nmdl_errores_corr_rationalquad&lt;- gls(Rto ~ N + N2 + Z + N*Z + N2*Z + N*N2*Z,  \ncorrelation = corRatio(form=~ X + Y,\nnugget=FALSE,\nmetric='euclidean'),\ndata = datos_ensayo_n)\n\n\n\n\nComparacion de modelos\nLa comparación de los modelos se realiza en términos de AIC y BIC. Menor valor de índice indica mejor ajuste.\n\ndata.frame(\n  Modelo = c('Errores Independientes',\n             'Correlacion Espacial (Exp)',\n             'Correlacion Espacial (Gaussian)',\n             'Correlacion Espacial (Linear)',\n             'Correlacion Espacial (Spheric)',\n             'Correlacion Espacial (Rational Quadratic)'),\n  AIC = c(AIC(mdl_errores_indep), \n          AIC(mdl_errores_corr_exp),\n          AIC(mdl_errores_corr_gau),\n          AIC(mdl_errores_corr_lin),\n          AIC(mdl_errores_corr_spher),\n          AIC(mdl_errores_corr_rationalquad)),\n  BIC = c(BIC(mdl_errores_indep), \n          BIC(mdl_errores_corr_exp),\n          BIC(mdl_errores_corr_gau),\n          BIC(mdl_errores_corr_lin),\n          BIC(mdl_errores_corr_spher),\n          BIC(mdl_errores_corr_rationalquad))\n) |&gt; \n  arrange(AIC, BIC)\n\n\n\n\n\nModelo\nAIC\nBIC\n\n\n\n\nCorrelacion Espacial (Exp)\n14828.11\n14914.71\n\n\nCorrelacion Espacial (Linear)\n14899.51\n14986.11\n\n\nCorrelacion Espacial (Spheric)\n14899.51\n14986.11\n\n\nCorrelacion Espacial (Rational Quadratic)\n14915.44\n15002.05\n\n\nCorrelacion Espacial (Gaussian)\n15012.82\n15099.42\n\n\nErrores Independientes\n15088.72\n15170.51\n\n\n\n\n\n\n\n\nModelo final\nSe realiza una eliminación de valores extremos. Valores extremos son aquellos valores poco probables de ocurrir en el contexto del modelo ajustado.\ndatos_ensayo_n_noout &lt;- \n  datos_ensayo_n[abs(residuals(mdl_errores_corr_exp, type = 'normalized')) &lt; 3,]\n\nmdl_errores_corr_exp &lt;- gls(Rto ~ N + N2 + Z + N*Z + N2*Z,  \ncorrelation = corExp(form=~ X + Y,\nnugget=FALSE,\nmetric='euclidean'),\ndata = datos_ensayo_n_noout)\n\ndatos_ensayo_n_noout$resid_corr_exp &lt;- \n  residuals(mdl_errores_corr_exp, type = 'normalized')\ndatos_ensayo_n_noout$pred_corr_exp &lt;- \n  predict(mdl_errores_corr_exp)\n\nggplot2::ggplot(datos_ensayo_n_noout, ggplot2::aes(sample = resid_corr_exp)) +\n        ggplot2::geom_qq(\n            colour = \"black\",\n            fill = \"aquamarine3\",\n            size = 2,\n            shape = 21\n        ) +\n        ggplot2::geom_qq_line() +\n        ggplot2::theme_bw() +\n        ggplot2::labs(y = \"Standardised Residual\", x = \"Theoretical\")\nggplot2::ggplot(\n        data = datos_ensayo_n_noout,\n        mapping = ggplot2::aes(x = pred_corr_exp, y = resid_corr_exp)\n        ) +\n        ggplot2::geom_point(\n            colour = \"black\",\n            fill = \"aquamarine3\",\n            size = 2,\n            shape = 21\n        ) +\n        ggplot2::theme_bw() +\n        ggplot2::labs(y = \"Standardised Residual\", x = \"Fitted Value\")\nggplot2::ggplot(\n        data = datos_ensayo_n_noout,\n        mapping = ggplot2::aes(x = Z, y = resid_corr_exp)\n        ) +\n        ggplot2::geom_boxplot(\n            colour = \"black\",\n            fill = \"aquamarine3\",\n            size = 2,\n            shape = 21\n        ) +\n        ggplot2::theme_bw() +\n        ggplot2::labs(y = \"Standardised Residual\", x = \"Zona\")\nggplot2::ggplot(\n        data = datos_ensayo_n_noout,\n        mapping = ggplot2::aes(x = N, y = resid_corr_exp)\n        ) +\n        ggplot2::geom_point(\n            colour = \"black\",\n            fill = \"aquamarine3\",\n            size = 2,\n            shape = 21\n        ) +\n        ggplot2::theme_bw() +\n        ggplot2::labs(y = \"Standardised Residual\", x = \"Nitrogeno\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\njoint_tests(mdl_errores_corr_exp)\n\n\n\n\n\n\nmodel term\ndf1\ndf2\nF.ratio\np.value\n\n\n\n\n1\nN\n1\n748.19\n71.015\n0.0000000\n\n\n3\nN2\n1\n772.05\n22.751\n0.0000022\n\n\n5\nZ\n3\n573.64\n8.920\n0.0000088\n\n\n2\nN:Z\n3\n874.97\n11.393\n0.0000002\n\n\n4\nN2:Z\n3\n877.05\n4.184\n0.0059351\n\n\n\n\n\n\n\nmodelb &lt;- emmeans(mdl_errores_corr_exp, c(\"Z\", \"N\"), type = \"response\")\nmultcomp::cld(modelb, Letters = LETTERS, alpha = 0.05)  |&gt;\n  as.data.frame(row.names = NULL) |&gt;\n  dplyr::rename(mean = emmean) \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nZ\nN\nmean\nSE\ndf\nlower.CL\nupper.CL\n.group\n\n\n\n\n4\n4\n217.4645\n7191.933\n353.3154\n9.249300\n6395.950\n7987.917\nA\n\n\n3\n3\n217.4645\n7733.930\n334.2457\n7.617351\n6956.366\n8511.494\nB\n\n\n1\n1\n217.4645\n8107.623\n330.1085\n7.083304\n7328.898\n8886.349\nBC\n\n\n2\n2\n217.4645\n8156.014\n324.5728\n6.811757\n7384.201\n8927.828\nC\n\n\n\n\n\n\n\ncoefficients(mdl_errores_corr_exp) \n\n  (Intercept)             N            N2            Z2            Z3 \n 5.789522e+03  1.761205e+01 -2.071094e-02  4.061305e+02  7.127285e+02 \n           Z4          N:Z2          N:Z3          N:Z4         N2:Z2 \n 9.791665e+02 -2.265393e+00 -7.998081e+00 -1.487809e+01  1.847995e-03 \n        N2:Z3         N2:Z4 \n 8.943546e-03  1.836445e-02"
  },
  {
    "objectID": "MLM_CorrEsp_OFE_Reg.html#grafico-de-modelo-ajustado",
    "href": "MLM_CorrEsp_OFE_Reg.html#grafico-de-modelo-ajustado",
    "title": "Diplomatura_MLM_R",
    "section": "Grafico de modelo ajustado",
    "text": "Grafico de modelo ajustado\nGrilla de predicción\n\nrange_n_by_zone &lt;- datos_ensayo_n_noout |&gt;\n  st_drop_geometry() |&gt;\n  group_by(Z) |&gt;\n  summarise(min_N = min(N), max_N = max(N))\n\ngrid_pred &lt;- range_n_by_zone |&gt;\n  rowwise() |&gt;\n  do({\n    data.frame(\n      Z = .$Z,\n      N = seq(.$min_N, .$max_N, length.out = 100)\n    )\n  }) |&gt;\n  ungroup() |&gt;\n  mutate(\n    N2 = N^2\n  )\n\nPrediccion de rendimiento\n\ngrid_pred$Rto_pred &lt;- predict(mdl_errores_corr_exp, newdata = grid_pred)\n\nOptima dosis de N para cada zona\n\nopt_n_by_zone &lt;- grid_pred %&gt;%\n  group_by(Z) %&gt;%\n  slice_max(Rto_pred, n = 1, with_ties = FALSE) |&gt;\n  select(Z, N, Rto_pred)\n\nopt_n_by_zone\n\n\n\n\n\nZ\nN\nRto_pred\n\n\n\n\n1\n426.6667\n9533.686\n\n\n2\n408.8889\n9317.032\n\n\n3\n408.8889\n8465.904\n\n\n4\n440.0000\n7517.349\n\n\n\n\n\n\nGrafico de rendimientos predichos\n\nggplot(grid_pred, aes(x = N, y = Rto_pred, color = Z)) +\n  geom_line() +\n  geom_point(data = opt_n_by_zone, aes(x = N, y = Rto_pred), size = 3) +\n  labs(x = \"Dosis de N\", y = \"Rendimiento predicho (Kg/ha)\") +\n  theme_minimal()"
  },
  {
    "objectID": "Datos/Dia 2/Zonificacion/datos/Lote 1/Lote_1_PS.html",
    "href": "Datos/Dia 2/Zonificacion/datos/Lote 1/Lote_1_PS.html",
    "title": "Diplomatura_MLM_R",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     \n\n\n        0 0     false"
  },
  {
    "objectID": "Datos/Dia 2/datos/Lote 1/Lote_1_PS.html",
    "href": "Datos/Dia 2/datos/Lote 1/Lote_1_PS.html",
    "title": "Diplomatura_MLM_R",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     \n\n\n        0 0     false"
  },
  {
    "objectID": "about.html#tipos-de-ensayos",
    "href": "about.html#tipos-de-ensayos",
    "title": "About",
    "section": "",
    "text": "Los ensayos analizados corresponden a distintas configuraciones experimentales:\n\nParcelas tradicionales: diseño controlado con replicación y aleatorización.\nEnsayos OFE: realizados directamente en el lote, con unidades experimentales más grandes y representativas.\nFranjas y testigos apareados: estructuras más simples, comunes en contextos productivos, que requieren modelos adecuados para su análisis."
  },
  {
    "objectID": "about.html#objetivos-del-análisis",
    "href": "about.html#objetivos-del-análisis",
    "title": "About",
    "section": "",
    "text": "Evaluar el efecto de prácticas de manejo como la fertilización con fósforo (con y sin zinc) y el uso de diferentes dosis de nitrógeno.\nAnalizar la interacción entre tratamientos y zonas de manejo (management zones).\nDeterminar si es necesario aplicar un manejo diferencial por ambiente.\nAjustar modelos mixtos lineales, con y sin correlación espacial.\nEstimar medias ajustadas, comparaciones múltiples y dosis óptimas por zona."
  },
  {
    "objectID": "about.html#herramientas-utilizadas",
    "href": "about.html#herramientas-utilizadas",
    "title": "About",
    "section": "",
    "text": "Tip\n\n\n\nLos análisis se realizan en R, utilizando paquetes específicos:\n\n\n\ndplyr para manipulación de datos\nsf y tmap para análisis y visualización espacial\nnlme para ajuste de modelos mixtos\nemmeans y multcomp para estimación de medias y comparación de tratamientos\nggplot2 para visualización de resultados"
  },
  {
    "objectID": "about.html#estructura-del-tutorial",
    "href": "about.html#estructura-del-tutorial",
    "title": "About",
    "section": "",
    "text": "El material está organizado en dos grandes secciones:\n\n\nEvaluación del efecto de tratamientos de fertilización fosforada en distintas zonas del lote. Se comparan tratamientos mediante modelos mixtos con y sin correlación espacial, y se visualizan las medias ajustadas por ambiente.\n\n\n\nEvaluación de la respuesta del cultivo a cuatro dosis de nitrógeno en cuatro zonas de manejo. Se ajustan modelos polinómicos y se predicen las dosis óptimas de N por zona, considerando estructuras espaciales de error."
  },
  {
    "objectID": "index.html#tipos-de-ensayos",
    "href": "index.html#tipos-de-ensayos",
    "title": "Modelos Lineales Mixtos en R",
    "section": "Tipos de ensayos",
    "text": "Tipos de ensayos\nLos ensayos analizados corresponden a distintas configuraciones experimentales:\n\nParcelas tradicionales: diseño controlado con replicación y aleatorización.\nEnsayos OFE: realizados directamente en el lote, con unidades experimentales más grandes y representativas.\nFranjas y testigos apareados: estructuras más simples, comunes en contextos productivos, que requieren modelos adecuados para su análisis."
  },
  {
    "objectID": "index.html#objetivos-del-análisis",
    "href": "index.html#objetivos-del-análisis",
    "title": "Modelos Lineales Mixtos en R",
    "section": "Objetivos del análisis",
    "text": "Objetivos del análisis\n\nEvaluar el efecto de prácticas de manejo como la fertilización con fósforo (con y sin zinc) y el uso de diferentes dosis de nitrógeno.\nAnalizar la interacción entre tratamientos y zonas de manejo (management zones).\nDeterminar si es necesario aplicar un manejo diferencial por ambiente.\nAjustar modelos mixtos lineales, con y sin correlación espacial.\nEstimar medias ajustadas, comparaciones múltiples y dosis óptimas por zona."
  },
  {
    "objectID": "index.html#herramientas-utilizadas",
    "href": "index.html#herramientas-utilizadas",
    "title": "Modelos Lineales Mixtos en R",
    "section": "Herramientas utilizadas",
    "text": "Herramientas utilizadas\n\n\n\n\n\n\nTip\n\n\n\nLos análisis se realizan en R, utilizando paquetes específicos:\n\n\n\ndplyr para manipulación de datos\nsf y tmap para análisis y visualización espacial\nnlme para ajuste de modelos mixtos\nemmeans y multcomp para estimación de medias y comparación de tratamientos\nggplot2 para visualización de resultados"
  },
  {
    "objectID": "index.html#estructura-del-tutorial",
    "href": "index.html#estructura-del-tutorial",
    "title": "Modelos Lineales Mixtos en R",
    "section": "Estructura del tutorial",
    "text": "Estructura del tutorial\nEl material está organizado en dos grandes secciones:\n\nEnsayos en estaciones experimentales\n\n\nEnsayo con testigos apareados:\nEvaluación del efecto de una práctica de manejo en ambientes contrastantes, utilizando modelos mixtos con y sin correlación espacial.\nEnsayo de cultivares de trigo (DBCA):\nAnálisis de un ensayo de comparación de cultivares utilizando un diseño en bloques completos al azar, con ajuste de modelos mixtos.\n\n\nEnsayo en capos de productores - On-Farm experiments\n\n\nOFE Regresión: Evaluación del efecto de tratamientos de fertilización fosforada en distintas zonas del lote. Se comparan tratamientos mediante modelos mixtos con y sin correlación espacial, y se visualizan las medias ajustadas por ambiente.\nOFE Clasificación: Evaluación de la respuesta del cultivo a cuatro dosis de nitrógeno en cuatro zonas de manejo. Se ajustan modelos polinómicos y se predicen las dosis óptimas de N por zona, considerando estructuras espaciales de error."
  },
  {
    "objectID": "about.html#ensayos-disponibles",
    "href": "about.html#ensayos-disponibles",
    "title": "About",
    "section": "",
    "text": "🔬 Ensayo con testigos apareados:\nEvaluación del efecto de una práctica de manejo en ambientes contrastantes, utilizando modelos mixtos con y sin correlación espacial.\n🌾 Ensayo de cultivares de trigo (DBCA):\nAnálisis de un ensayo de comparación de cultivares utilizando un diseño en bloques completos al azar, con ajuste de modelos mixtos."
  },
  {
    "objectID": "about.html#objetivo",
    "href": "about.html#objetivo",
    "title": "About",
    "section": "",
    "text": "Brindar ejemplos reproducibles de análisis de ensayos que integren: - Estadística descriptiva - Modelos lineales mixtos - Modelización espacial - Comparaciones múltiples\nTodos los análisis fueron realizados con R y Quarto, fomentando la reproducibilidad y la comunicación de resultados."
  },
  {
    "objectID": "about.html#contacto",
    "href": "about.html#contacto",
    "title": "About",
    "section": "",
    "text": "Para dudas o sugerencias, podés contactarme a través de LinkedIn o vía correo institucional."
  },
  {
    "objectID": "Trigo_DBCA.html",
    "href": "Trigo_DBCA.html",
    "title": "Modelos lineales mixtos con correlacion espacial.",
    "section": "",
    "text": "library(dplyr)\nlibrary(ggplot2)\n\nlibrary(nlme)\nlibrary(emmeans)"
  },
  {
    "objectID": "Trigo_DBCA.html#ensayo-evaluación-de-cultivares-de-trigo",
    "href": "Trigo_DBCA.html#ensayo-evaluación-de-cultivares-de-trigo",
    "title": "Modelos lineales mixtos con correlacion espacial.",
    "section": "Ensayo evaluación de cultivares de trigo",
    "text": "Ensayo evaluación de cultivares de trigo\n\nSe evaluaron 15 cultivares comerciales y 35 líneas experimentales de trigo.\nEl ensayo se realizó bajo un DBCA con 3 repeticiones.\nSe registró la posición espacial de cada parcela, y columnas (x) y filas (y).\n\n\nEstadistica descriptiva\n\ndatos_trigo &lt;- read.table('Datos/Dia 1/Trigo.txt',\nsep = '\\t',\nheader = TRUE,\ndec = ',')\n\ndatos_trigo &lt;- \n  datos_trigo |&gt;\n  mutate(Bloque = as.character(Bloque))\n\n\nhead(datos_trigo)\n\n\n\n\n\nGenotipo\nColumna1\nBloque_vis\nBloque\nFila\nRendimiento\n\n\n\n\nG01\n1\n1\n1\n1\n3.37917\n\n\nG02\n2\n1\n1\n2\n3.58748\n\n\nG03\n3\n1\n1\n3\n4.32812\n\n\nG04\n4\n1\n1\n4\n4.53642\n\n\nG05\n5\n1\n1\n5\n2.59224\n\n\nG06\n6\n1\n1\n6\n2.40708\n\n\n\n\n\n\nggplot(datos_trigo, aes(Bloque, Fila)) +\n  geom_raster(aes(fill = Genotipo))\nggplot(datos_trigo, aes(Bloque, Fila)) +\n  geom_raster(aes(fill = Rendimiento))\n\n\n\n\n\n\n\n\n\n\n\nggplot(datos_trigo, aes(Genotipo, Rendimiento)) +\n  stat_summary(fun.data = mean_se)\n\n\n\n\n\n\n\n\n\n\nAjuste de modelo\n\nSin contemplar correlación espacial\n\nmdl_errores_indep &lt;- lme(Rendimiento ~ Genotipo, \nlist(Bloque=pdIdent(~1)),\ndata = datos_trigo)\n\ndatos_trigo$resid_indep &lt;- \n  residuals(mdl_errores_indep, type = 'normalized')\ndatos_trigo$pred_indep &lt;- \n  predict(mdl_errores_indep)\n\nggplot(datos_trigo, aes(sample = resid_indep)) +\n        geom_qq(\n            colour = \"black\",\n            fill = \"aquamarine3\",\n            size = 2,\n            shape = 21\n        ) +\n        geom_qq_line() +\n        theme_bw() +\n        labs(y = \"Standardised Residual\", \n        x = \"Theoretical\")\nggplot(\n        data = datos_trigo,\n        mapping = aes(x = pred_indep, y = resid_indep)\n        ) +\n        geom_point(\n            colour = \"black\",\n            fill = \"aquamarine3\",\n            size = 2,\n            shape = 21\n        ) +\n        theme_bw() +\n        labs(y = \"Standardised Residual\",\n         x = \"Fitted Value\")\nggplot(\n        data = datos_trigo,\n        mapping = aes(x = Bloque, y = resid_indep)\n        ) +\n        geom_boxplot(\n            colour = \"black\",\n            fill = \"aquamarine3\",\n            size = 2,\n            shape = 21\n        ) +\n        theme_bw() +\n        labs(y = \"Standardised Residual\", x = \"Bloque\")\nggplot(\n        data = datos_trigo,\n        mapping = aes(x = Genotipo, y = resid_indep)\n        ) +\n        geom_boxplot(\n            colour = \"black\",\n            fill = \"aquamarine3\",\n            size = 2,\n            shape = 21\n        ) +\n        theme_bw() +\n        labs(y = \"Standardised Residual\", x = \"Genotipo\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\njoint_tests(mdl_errores_indep)\n\n\n\n\n\nmodel term\ndf1\ndf2\nF.ratio\np.value\n\n\n\n\nGenotipo\n49\n98\n1.809\n0.0066113\n\n\n\n\n\n\n\nemmeans(mdl_errores_indep, 'Genotipo') |&gt;\n  as.data.frame() |&gt;\n  arrange(emmean)\n\n\n\n\n\nGenotipo\nemmean\nSE\ndf\nlower.CL\nupper.CL\n\n\n\n\nG36\n1.465850\n0.4150057\n2\n-0.3197755\n3.251476\n\n\nG30\n1.604720\n0.4150057\n2\n-0.1809055\n3.390346\n\n\nG33\n1.712730\n0.4150057\n2\n-0.0728955\n3.498356\n\n\nG45\n1.743590\n0.4150057\n2\n-0.0420355\n3.529215\n\n\nG46\n1.759020\n0.4150057\n2\n-0.0266055\n3.544646\n\n\nG28\n1.774450\n0.4150057\n2\n-0.0111755\n3.560075\n\n\nG38\n1.789880\n0.4150057\n2\n0.0042545\n3.575505\n\n\nG48\n1.789880\n0.4150057\n2\n0.0042545\n3.575505\n\n\nG49\n1.789880\n0.4150057\n2\n0.0042545\n3.575505\n\n\nG27\n1.805310\n0.4150057\n2\n0.0196845\n3.590936\n\n\nG23\n1.851600\n0.4150057\n2\n0.0659745\n3.637226\n\n\nG35\n1.990470\n0.4150057\n2\n0.2048445\n3.776095\n\n\nG37\n2.044477\n0.4150057\n2\n0.2588511\n3.830102\n\n\nG19\n2.083050\n0.4150057\n2\n0.2974245\n3.868676\n\n\nG29\n2.083050\n0.4150057\n2\n0.2974245\n3.868676\n\n\nG24\n2.083050\n0.4150057\n2\n0.2974245\n3.868676\n\n\nG34\n2.113910\n0.4150057\n2\n0.3282845\n3.899535\n\n\nG47\n2.221920\n0.4150057\n2\n0.4362945\n4.007545\n\n\nG25\n2.252780\n0.4150057\n2\n0.4671545\n4.038405\n\n\nG13\n2.252780\n0.4150057\n2\n0.4671545\n4.038405\n\n\nG07\n2.268210\n0.4150057\n2\n0.4825845\n4.053835\n\n\nG05\n2.299070\n0.4150057\n2\n0.5134445\n4.084695\n\n\nG21\n2.329930\n0.4150057\n2\n0.5443045\n4.115556\n\n\nG22\n2.345360\n0.4150057\n2\n0.5597345\n4.130986\n\n\nG43\n2.399367\n0.4150057\n2\n0.6137411\n4.184992\n\n\nG26\n2.422510\n0.4150057\n2\n0.6368845\n4.208136\n\n\nG31\n2.445657\n0.4150057\n2\n0.6600311\n4.231282\n\n\nG06\n2.530520\n0.4150057\n2\n0.7448945\n4.316146\n\n\nG40\n2.530520\n0.4150057\n2\n0.7448945\n4.316146\n\n\nG44\n2.561380\n0.4150057\n2\n0.7757545\n4.347005\n\n\nG15\n2.561380\n0.4150057\n2\n0.7757545\n4.347005\n\n\nG10\n2.592240\n0.4150057\n2\n0.8066145\n4.377866\n\n\nG39\n2.638530\n0.4150057\n2\n0.8529045\n4.424156\n\n\nG41\n2.669390\n0.4150057\n2\n0.8837645\n4.455016\n\n\nG50\n2.669390\n0.4150057\n2\n0.8837645\n4.455016\n\n\nG14\n2.731110\n0.4150057\n2\n0.9454845\n4.516736\n\n\nG08\n2.754257\n0.4150057\n2\n0.9686311\n4.539882\n\n\nG16\n2.893127\n0.4150057\n2\n1.1075011\n4.678752\n\n\nG42\n2.900840\n0.4150057\n2\n1.1152145\n4.686465\n\n\nG12\n3.039710\n0.4150057\n2\n1.2540845\n4.825336\n\n\nG03\n3.047427\n0.4150057\n2\n1.2618011\n4.833052\n\n\nG18\n3.062857\n0.4150057\n2\n1.2772311\n4.848482\n\n\nG02\n3.093717\n0.4150057\n2\n1.3080911\n4.879342\n\n\nG09\n3.224870\n0.4150057\n2\n1.4392445\n5.010496\n\n\nG11\n3.255730\n0.4150057\n2\n1.4701045\n5.041355\n\n\nG20\n3.263447\n0.4150057\n2\n1.4778211\n5.049072\n\n\nG32\n3.294307\n0.4150057\n2\n1.5086811\n5.079932\n\n\nG01\n3.402317\n0.4150057\n2\n1.6166911\n5.187942\n\n\nG04\n3.564330\n0.4150057\n2\n1.7787045\n5.349956\n\n\nG17\n3.610620\n0.4150057\n2\n1.8249945\n5.396246\n\n\n\n\n\n\n\n\nContemplando correlación espacial\n\nmdl_errores_corr_exp &lt;- lme(Rendimiento ~ Genotipo, \nrandom = list(Bloque=pdIdent(~1)),\ncorrelation = corExp(form=~Bloque_vis + Fila,\nnugget=FALSE,\nmetric='euclidean'),\ndata = datos_trigo)\n\n\nmdl_errores_corr_gau &lt;- lme(Rendimiento ~ Genotipo, \nrandom = list(Bloque=pdIdent(~1)),\ncorrelation = corGaus(form=~Bloque_vis + Fila,\nnugget=FALSE,\nmetric='euclidean'),\ndata = datos_trigo)\n\nmdl_errores_corr_lin &lt;- lme(Rendimiento ~ Genotipo, \nrandom = list(Bloque=pdIdent(~1)),\ncorrelation = corLin(form=~Bloque_vis + Fila,\nnugget=FALSE,\nmetric='euclidean'),\ndata = datos_trigo)\n\nmdl_errores_corr_spher &lt;- lme(Rendimiento ~ Genotipo, \nrandom = list(Bloque=pdIdent(~1)),\ncorrelation = corSpher(form=~Bloque_vis + Fila,\nnugget=FALSE,\nmetric='euclidean'),\ndata = datos_trigo)\n\nmdl_errores_corr_rationalquad&lt;- lme(Rendimiento ~ Genotipo, \nrandom = list(Bloque=pdIdent(~1)),\ncorrelation = corRatio(form=~Bloque_vis + Fila,\nnugget=FALSE,\nmetric='euclidean'),\ndata = datos_trigo)\n\n\n\n\nComparacion de modelos\n\ndata.frame(\n  Modelo = c('Errores Independientes',\n             'Correlacion Espacial (Exp)',\n             'Correlacion Espacial (Gaussian)',\n             'Correlacion Espacial (Linear)',\n             'Correlacion Espacial (Spheric)',\n             'Correlacion Espacial (Rational Quadratic)'),\n  AIC = c(AIC(mdl_errores_indep), \n          AIC(mdl_errores_corr_exp),\n          AIC(mdl_errores_corr_gau),\n          AIC(mdl_errores_corr_lin),\n          AIC(mdl_errores_corr_spher),\n          AIC(mdl_errores_corr_rationalquad)\n          ),\n  BIC = c(BIC(mdl_errores_indep), \n          BIC(mdl_errores_corr_exp),\n          BIC(mdl_errores_corr_gau),\n          BIC(mdl_errores_corr_lin),\n          BIC(mdl_errores_corr_spher),\n          BIC(mdl_errores_corr_rationalquad))\n) |&gt; \n  arrange(AIC, BIC)\n\n\n\n\n\nModelo\nAIC\nBIC\n\n\n\n\nCorrelacion Espacial (Linear)\n305.3934\n443.4674\n\n\nCorrelacion Espacial (Exp)\n306.1659\n444.2400\n\n\nCorrelacion Espacial (Spheric)\n311.3027\n449.3767\n\n\nCorrelacion Espacial (Rational Quadratic)\n316.7885\n454.8625\n\n\nCorrelacion Espacial (Gaussian)\n334.8265\n472.9005\n\n\nErrores Independientes\n376.6707\n512.1395\n\n\n\n\n\n\n\n\nModelo final\ndatos_trigo$resid_corr_lin &lt;- \n  residuals(mdl_errores_corr_lin, type = 'normalized')\ndatos_trigo$pred_corr_lin &lt;- \n  predict(mdl_errores_corr_lin)\n\nggplot(datos_trigo, aes(sample = resid_corr_lin)) +\n        geom_qq(\n            colour = \"black\",\n            fill = \"aquamarine3\",\n            size = 2,\n            shape = 21\n        ) +\n        geom_qq_line() +\n        theme_bw() +\n        labs(y = \"Standardised Residual\", x = \"Theoretical\")\nggplot(\n        data = datos_trigo,\n        mapping = aes(x = pred_corr_lin, y = resid_corr_lin)\n        ) +\n        geom_point(\n            colour = \"black\",\n            fill = \"aquamarine3\",\n            size = 2,\n            shape = 21\n        ) +\n        theme_bw() +\n        labs(y = \"Standardised Residual\", x = \"Fitted Value\")\nggplot(\n        data = datos_trigo,\n        mapping = aes(x = Bloque, y = resid_corr_lin)\n        ) +\n        geom_boxplot(\n            colour = \"black\",\n            fill = \"aquamarine3\",\n            size = 2,\n            shape = 21\n        ) +\n        theme_bw() +\n        labs(y = \"Standardised Residual\", x = \"Bloque\")\nggplot(\n        data = datos_trigo,\n        mapping = aes(x = Genotipo, y = resid_corr_lin)\n        ) +\n        geom_boxplot(\n            colour = \"black\",\n            fill = \"aquamarine3\",\n            size = 2,\n            shape = 21\n        ) +\n        theme_bw() +\n        labs(y = \"Standardised Residual\", x = \"Genotipo\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\njoint_tests(mdl_errores_corr_lin)\n\n\n\n\n\nmodel term\ndf1\ndf2\nF.ratio\np.value\n\n\n\n\nGenotipo\n49\n98\n6.667\n0\n\n\n\n\n\n\n\nemmeans(mdl_errores_corr_lin, 'Genotipo') |&gt;\n  as.data.frame() |&gt;\n  arrange(emmean)\n\n\n\n\n\nGenotipo\nemmean\nSE\ndf\nlower.CL\nupper.CL\n\n\n\n\nG28\n1.476768\n0.3023253\n2\n0.1759668\n2.777568\n\n\nG36\n1.538156\n0.2970479\n2\n0.2600621\n2.816250\n\n\nG21\n1.761386\n0.2940460\n2\n0.4962077\n3.026563\n\n\nG43\n1.809996\n0.2994555\n2\n0.5215430\n3.098449\n\n\nG46\n1.840904\n0.2967700\n2\n0.5640060\n3.117802\n\n\nG45\n1.887223\n0.3024035\n2\n0.5860863\n3.188360\n\n\nG07\n1.909751\n0.2942985\n2\n0.6434873\n3.176016\n\n\nG29\n1.978285\n0.2945636\n2\n0.7108797\n3.245689\n\n\nG30\n1.998038\n0.2949078\n2\n0.7291527\n3.266924\n\n\nG49\n2.017462\n0.2937601\n2\n0.7535146\n3.281410\n\n\nG06\n2.068855\n0.3003842\n2\n0.7764063\n3.361304\n\n\nG23\n2.081663\n0.2999518\n2\n0.7910741\n3.372251\n\n\nG38\n2.136192\n0.2952369\n2\n0.8658903\n3.406494\n\n\nG33\n2.141480\n0.2964796\n2\n0.8658307\n3.417129\n\n\nG15\n2.259164\n0.2972114\n2\n0.9803666\n3.537961\n\n\nG44\n2.302427\n0.2991998\n2\n1.0150747\n3.589780\n\n\nG31\n2.326669\n0.2939662\n2\n1.0618348\n3.591504\n\n\nG27\n2.347612\n0.3013353\n2\n1.0510702\n3.644153\n\n\nG37\n2.357334\n0.2973078\n2\n1.0781211\n3.636546\n\n\nG34\n2.378812\n0.2969033\n2\n1.1013406\n3.656284\n\n\nG48\n2.381430\n0.3006979\n2\n1.0876319\n3.675229\n\n\nG39\n2.410992\n0.3006901\n2\n1.1172271\n3.704757\n\n\nG19\n2.411993\n0.2896015\n2\n1.1659380\n3.658047\n\n\nG05\n2.417046\n0.2976442\n2\n1.1363868\n3.697706\n\n\nG25\n2.419023\n0.2950482\n2\n1.1495331\n3.688513\n\n\nG24\n2.430671\n0.2993659\n2\n1.1426037\n3.718739\n\n\nG35\n2.471400\n0.2925652\n2\n1.2125933\n3.730206\n\n\nG41\n2.492912\n0.3012054\n2\n1.1969293\n3.788894\n\n\nG47\n2.522935\n0.2955686\n2\n1.2512058\n3.794664\n\n\nG18\n2.534374\n0.3004206\n2\n1.2417685\n3.826980\n\n\nG14\n2.585068\n0.3022517\n2\n1.2845836\n3.885552\n\n\nG26\n2.589415\n0.2948478\n2\n1.3207879\n3.858043\n\n\nG08\n2.601926\n0.2995628\n2\n1.3130110\n3.890840\n\n\nG13\n2.609047\n0.2948342\n2\n1.3404775\n3.877616\n\n\nG40\n2.658114\n0.3044837\n2\n1.3480260\n3.968202\n\n\nG22\n2.672658\n0.3003799\n2\n1.3802276\n3.965089\n\n\nG16\n2.797675\n0.3067174\n2\n1.4779770\n4.117374\n\n\nG42\n2.850870\n0.2964127\n2\n1.5755091\n4.126231\n\n\nG03\n2.874526\n0.2945488\n2\n1.6071851\n4.141868\n\n\nG02\n2.892058\n0.2959940\n2\n1.6184990\n4.165617\n\n\nG10\n2.899056\n0.2959095\n2\n1.6258600\n4.172251\n\n\nG50\n3.019208\n0.2984731\n2\n1.7349821\n4.303435\n\n\nG20\n3.041012\n0.2950525\n2\n1.7715036\n4.310521\n\n\nG11\n3.069149\n0.3044282\n2\n1.7593005\n4.378998\n\n\nG32\n3.069396\n0.2936543\n2\n1.8059038\n4.332889\n\n\nG01\n3.107186\n0.3103365\n2\n1.7719153\n4.442456\n\n\nG09\n3.107770\n0.2973122\n2\n1.8285389\n4.387001\n\n\nG17\n3.207479\n0.2965052\n2\n1.9317205\n4.483238\n\n\nG04\n3.363593\n0.2989042\n2\n2.0775123\n4.649674\n\n\nG12\n3.403372\n0.2990477\n2\n2.1166740\n4.690071"
  },
  {
    "objectID": "Testigos_Apareados.html",
    "href": "Testigos_Apareados.html",
    "title": "Modelos lineales mixtos con correlacion espacial.",
    "section": "",
    "text": "library(dplyr)\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\nlibrary(ggplot2)\n\nlibrary(nlme)\n\n\nAttaching package: 'nlme'\n\n\nThe following object is masked from 'package:dplyr':\n\n    collapse\n\nlibrary(emmeans)\n\nWelcome to emmeans.\nCaution: You lose important information if you filter this package's results.\nSee '? untidy'"
  },
  {
    "objectID": "Testigos_Apareados.html#ensayo-testigos-a-la-par",
    "href": "Testigos_Apareados.html#ensayo-testigos-a-la-par",
    "title": "Modelos lineales mixtos con correlacion espacial.",
    "section": "Ensayo testigos a la par",
    "text": "Ensayo testigos a la par\n\nSe evalúan 16 híbridos y un testigo común intercalado\nEl testigo permite modelar los efectos sistemáticos de la calidad del terreno donde se ubican las UE.\n\n\nEstadistica descriptiva\n\ndatos_testigosap &lt;- read.table('Datos/Dia 1/Testigos_apareados.txt',\nsep = '\\t',\nheader = TRUE)\n\n\nhead(datos_testigosap)\n\n\n\n\n\nPosicion\nHibrido\nRendimiento\nTes\nHib\nDif\nPRED_Dif\n\n\n\n\n1\nTestigo\n896\n896\n886\n-10\n75.03804\n\n\n2\nH1\n886\nNA\nNA\nNA\n64.55978\n\n\n3\nH2\n1037\nNA\nNA\nNA\n54.08152\n\n\n4\nTestigo\n1101\n1101\n1037\n-64\n43.60326\n\n\n5\nTestigo\n1055\n1055\n1222\n167\n33.12500\n\n\n6\nH3\n1222\nNA\nNA\nNA\n22.64674\n\n\n\n\n\n\nggplot(datos_testigosap, aes(Posicion, Rendimiento, color = Hibrido == 'Testigo')) +\n  geom_point()\n\n\n\n\n\n\n\n\n\nAjuste de modelo\n\nErrores independientes\n\nmdl_errores_indep &lt;- aov(Rendimiento ~ Hibrido, \ndata = datos_testigosap)\n\n\n\nContemplando correlación espacial\n\nmdl_errores_corr_exp &lt;- gls(Rendimiento ~ Hibrido, \ncorrelation = corExp(form=~Posicion,\nnugget=FALSE,\nmetric='euclidean'),\ndata = datos_testigosap)\n\n\nmdl_errores_corr_gau &lt;- gls(Rendimiento ~ Hibrido, \ncorrelation = corGaus(form=~Posicion,\nnugget=FALSE,\nmetric='euclidean'),\ndata = datos_testigosap)\n\nmdl_errores_corr_lin &lt;- gls(Rendimiento ~ Hibrido, \ncorrelation = corLin(form=~Posicion,\nnugget=FALSE,\nmetric='euclidean'),\ndata = datos_testigosap)\n\nmdl_errores_corr_spher &lt;- gls(Rendimiento ~ Hibrido, \ncorrelation = corSpher(form=~Posicion,\nnugget=FALSE,\nmetric='euclidean'),\ndata = datos_testigosap)\n\nmdl_errores_corr_rationalquad&lt;- gls(Rendimiento ~ Hibrido, \ncorrelation = corRatio(form=~Posicion,\nnugget=FALSE,\nmetric='euclidean'),\ndata = datos_testigosap)\n\n\n\n\nComparacion de modelos\n\ndata.frame(\n  Modelo = c('Errores Independientes',\n             'Correlacion Espacial (Exp)',\n             'Correlacion Espacial (Gaussian)',\n             'Correlacion Espacial (Linear)',\n             'Correlacion Espacial (Spheric)',\n             'Correlacion Espacial (Rational Quadratic)'),\n  AIC = c(AIC(mdl_errores_indep), \n          AIC(mdl_errores_corr_exp),\n          AIC(mdl_errores_corr_gau),\n          AIC(mdl_errores_corr_lin),\n          AIC(mdl_errores_corr_spher),\n          AIC(mdl_errores_corr_rationalquad)\n          ),\n  BIC = c(BIC(mdl_errores_indep), \n          BIC(mdl_errores_corr_exp),\n          BIC(mdl_errores_corr_gau),\n          BIC(mdl_errores_corr_lin),\n          BIC(mdl_errores_corr_spher),\n          BIC(mdl_errores_corr_rationalquad))\n) |&gt; \n  arrange(AIC, BIC)\n\n\n\n\n\nModelo\nAIC\nBIC\n\n\n\n\nCorrelacion Espacial (Exp)\n218.6227\n232.0756\n\n\nCorrelacion Espacial (Rational Quadratic)\n218.8059\n232.2589\n\n\nCorrelacion Espacial (Linear)\n219.1268\n232.5798\n\n\nCorrelacion Espacial (Gaussian)\n219.1685\n232.6214\n\n\nCorrelacion Espacial (Spheric)\n219.2063\n232.6593\n\n\nErrores Independientes\n398.1584\n424.5416\n\n\n\n\n\n\n\n\nModelo final\ndatos_testigosap$resid_corr_exp &lt;- residuals(mdl_errores_corr_exp, type = 'normalized')\ndatos_testigosap$pred_corr_exp &lt;- predict(mdl_errores_corr_exp)\n\nggplot2::ggplot(datos_testigosap, ggplot2::aes(sample = resid_corr_exp)) +\n        ggplot2::geom_qq(\n            colour = \"black\",\n            fill = \"aquamarine3\",\n            size = 2,\n            shape = 21\n        ) +\n        ggplot2::geom_qq_line() +\n        ggplot2::theme_bw() +\n        ggplot2::labs(y = \"Standardised Residual\", x = \"Theoretical\")\nggplot2::ggplot(\n        data = datos_testigosap,\n        mapping = ggplot2::aes(x = pred_corr_exp, y = resid_corr_exp)\n        ) +\n        ggplot2::geom_point(\n            colour = \"black\",\n            fill = \"aquamarine3\",\n            size = 2,\n            shape = 21\n        ) +\n        ggplot2::theme_bw() +\n        ggplot2::labs(y = \"Standardised Residual\", x = \"Fitted Value\")\nggplot2::ggplot(\n        data = datos_testigosap,\n        mapping = ggplot2::aes(x = Hibrido, y = resid_corr_exp)\n        ) +\n        ggplot2::geom_boxplot(\n            colour = \"black\",\n            fill = \"aquamarine3\",\n            size = 2,\n            shape = 21\n        ) +\n        ggplot2::theme_bw() +\n        ggplot2::labs(y = \"Standardised Residual\", x = \"Hibrido\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\njoint_tests(mdl_errores_corr_exp)\n\n\n\n\n\nmodel term\ndf1\ndf2\nF.ratio\np.value\n\n\n\n\nHibrido\n16\n6.9\n5.273\n0.0171447\n\n\n\n\n\n\n\nemmeans(mdl_errores_corr_exp, 'Hibrido') |&gt;\n  as.data.frame() |&gt;\n  arrange(emmean)\n\n\n\n\n\nHibrido\nemmean\nSE\ndf\nlower.CL\nupper.CL\n\n\n\n\nH15\n653.3557\n85.33059\n13.968702\n470.3013\n836.4101\n\n\nH13\n727.5479\n85.33059\n13.968702\n544.4935\n910.6023\n\n\nH16\n902.8669\n85.33059\n13.968702\n719.8125\n1085.9213\n\n\nH8\n933.4034\n85.33059\n13.968702\n750.3490\n1116.4577\n\n\nH7\n936.2055\n85.33059\n13.968702\n753.1511\n1119.2599\n\n\nH6\n966.3110\n85.33059\n13.968702\n783.2566\n1149.3654\n\n\nH12\n979.7981\n85.33059\n13.968702\n796.7437\n1162.8525\n\n\nH1\n1005.4633\n85.33059\n13.968702\n822.4089\n1188.5177\n\n\nH14\n1070.0660\n85.33059\n13.968702\n887.0116\n1253.1204\n\n\nH9\n1078.2818\n85.33059\n13.968702\n895.2274\n1261.3362\n\n\nH11\n1078.4279\n85.33059\n13.968702\n895.3736\n1261.4823\n\n\nH2\n1091.0732\n85.33059\n13.968702\n908.0188\n1274.1276\n\n\nTestigo\n1096.9845\n45.08659\n1.493844\n824.1424\n1369.8265\n\n\nH5\n1128.6462\n85.33059\n13.968702\n945.5918\n1311.7006\n\n\nH10\n1145.6426\n85.33059\n13.968702\n962.5882\n1328.6970\n\n\nH4\n1244.1896\n85.33059\n13.968702\n1061.1352\n1427.2440\n\n\nH3\n1248.3107\n85.33059\n13.968702\n1065.2563\n1431.3651"
  }
]